; Guage Standard Library: Extended List Operations
; Pure symbolic names, named parameters (converted to De Bruijn internally)

; ============================================================================
; Advanced List Search
; ============================================================================

; â‡¶ :: (Î± â†’ ğ”¹) â†’ [Î±] â†’ Î± | âˆ…
; Find - first element satisfying predicate (returns âˆ… if not found)
(â‰” â‡¶ (Î» (pred) (Î» (lst)
  (? (âˆ…? lst)
     âˆ…
     (? (pred (â— lst))
        (â— lst)
        ((â‡¶ pred) (â–· lst)))))))

; âŠ¡ :: â„• â†’ [Î±] â†’ Î± | âˆ…
; Nth - get element at index (0-based, returns âˆ… if out of bounds)
(â‰” âŠ¡ (Î» (idx) (Î» (lst)
  (? (âˆ…? lst)
     âˆ…
     (? (â‰¡ idx #0)
        (â— lst)
        ((âŠ¡ (âŠ– idx #1)) (â–· lst)))))))

; ============================================================================
; List Partitioning
; ============================================================================

; âŠ³ :: (Î± â†’ ğ”¹) â†’ [Î±] â†’ âŸ¨[Î±] [Î±]âŸ©
; Partition - split into (satisfies, doesn't-satisfy) pair
(â‰” âŠ³ (Î» (pred) (Î» (lst)
  (? (âˆ…? lst)
     (âŸ¨âŸ© âˆ… âˆ…)
     (? (pred (â— lst))
        ; Add to first list (satisfies)
        (âŸ¨âŸ© (âŸ¨âŸ© (â— lst) (â— ((âŠ³ pred) (â–· lst))))
            (â–· ((âŠ³ pred) (â–· lst))))
        ; Add to second list (doesn't satisfy)
        (âŸ¨âŸ© (â— ((âŠ³ pred) (â–· lst)))
            (âŸ¨âŸ© (â— lst) (â–· ((âŠ³ pred) (â–· lst))))))))))

; ============================================================================
; List Flattening
; ============================================================================

; âŠ :: [[Î±]] â†’ [Î±]
; Concat - flatten list of lists into single list
(â‰” âŠ (Î» (lst-of-lsts)
  (? (âˆ…? lst-of-lsts)
     âˆ…
     ; Append first list to flattened rest
     (â§º (âŠ (â–· lst-of-lsts)) (â— lst-of-lsts)))))

; ============================================================================
; List Insertion
; ============================================================================

; âŠŸ :: Î± â†’ [Î±] â†’ [Î±]
; Intersperse - insert separator between elements
(â‰” âŠŸ (Î» (sep) (Î» (lst)
  (? (âˆ…? lst)
     âˆ…
     (? (âˆ…? (â–· lst))
        ; Single element - no separator needed
        lst
        ; Multiple elements - add separator
        (âŸ¨âŸ© (â— lst) (âŸ¨âŸ© sep ((âŠŸ sep) (â–· lst)))))))))

; ============================================================================
; Cartesian Product
; ============================================================================

; âŠ  :: [Î±] â†’ [Î²] â†’ [âŸ¨Î± Î²âŸ©]
; Cartesian - cartesian product of two lists
(â‰” âŠ  (Î» (lst2) (Î» (lst1)
  (? (âˆ…? lst1)
     âˆ…
     (? (âˆ…? lst2)
        âˆ…
        ; For each element in lst1, pair with all elements in lst2
        (â§º ((âŠ  lst2) (â–· lst1))
            ((â†¦ (Î» (y) (âŸ¨âŸ© (â— lst1) y))) lst2)))))))

; ============================================================================
; Examples
; ============================================================================

; Find first >5: (â‡¶ (Î» (x) (> x #5)) (âŸ¨âŸ© #3 (âŸ¨âŸ© #7 (âŸ¨âŸ© #2 âˆ…))))  ; â†’ #7
; Get 2nd element: (âŠ¡ #1 (âŸ¨âŸ© :a (âŸ¨âŸ© :b (âŸ¨âŸ© :c âˆ…))))  ; â†’ :b
; Partition >5: (âŠ³ (Î» (x) (> x #5)) (âŸ¨âŸ© #3 (âŸ¨âŸ© #7 (âŸ¨âŸ© #2 (âŸ¨âŸ© #9 âˆ…)))))
;   â†’ (âŸ¨âŸ© (âŸ¨âŸ© #7 (âŸ¨âŸ© #9 âˆ…)) (âŸ¨âŸ© #3 (âŸ¨âŸ© #2 âˆ…)))
; Concat: (âŠ (âŸ¨âŸ© (âŸ¨âŸ© #1 (âŸ¨âŸ© #2 âˆ…)) (âŸ¨âŸ© (âŸ¨âŸ© #3 (âŸ¨âŸ© #4 âˆ…)) âˆ…)))  ; â†’ (âŸ¨âŸ© #1 (âŸ¨âŸ© #2 (âŸ¨âŸ© #3 (âŸ¨âŸ© #4 âˆ…))))
; Intersperse: (âŠŸ #0 (âŸ¨âŸ© #1 (âŸ¨âŸ© #2 (âŸ¨âŸ© #3 âˆ…))))  ; â†’ (âŸ¨âŸ© #1 (âŸ¨âŸ© #0 (âŸ¨âŸ© #2 (âŸ¨âŸ© #0 (âŸ¨âŸ© #3 âˆ…)))))
; Cartesian: (âŠ  (âŸ¨âŸ© #1 (âŸ¨âŸ© #2 âˆ…)) (âŸ¨âŸ© :a (âŸ¨âŸ© :b âˆ…)))
;   â†’ (âŸ¨âŸ© (âŸ¨âŸ© :a #1) (âŸ¨âŸ© (âŸ¨âŸ© :b #1) (âŸ¨âŸ© (âŸ¨âŸ© :a #2) (âŸ¨âŸ© (âŸ¨âŸ© :b #2) âˆ…))))
