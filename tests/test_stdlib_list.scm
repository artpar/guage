; Test Standard Library: List Operations
; Load stdlib first, then run tests

; ============================================================================
; Load stdlib
; ============================================================================

; Note: For now, we'll define inline. Later we'll have a proper module system.

; Helper: Build test list
(â‰” ğ•ƒ (âŸ¨âŸ© #1 (âŸ¨âŸ© #2 (âŸ¨âŸ© #3 âˆ…))))

; ============================================================================
; Test â†¦ (map)
; ============================================================================

(âŠ¨ :map-double
   (âŸ¨âŸ© #2 (âŸ¨âŸ© #4 (âŸ¨âŸ© #6 âˆ…)))
   (â†¦ (Î» (âŠ— 0 #2)) ğ•ƒ))

(âŠ¨ :map-empty
   âˆ…
   (â†¦ (Î» (âŠ• 0 #1)) âˆ…))

(âŠ¨ :map-increment
   (âŸ¨âŸ© #2 (âŸ¨âŸ© #3 (âŸ¨âŸ© #4 âˆ…)))
   (â†¦ (Î» (âŠ• 0 #1)) ğ•ƒ))

; ============================================================================
; Test âŠ² (filter)
; ============================================================================

(âŠ¨ :filter-gt-2
   (âŸ¨âŸ© #3 âˆ…)
   (âŠ² (Î» (> 0 #2)) ğ•ƒ))

(âŠ¨ :filter-empty
   âˆ…
   (âŠ² (Î» (> 0 #10)) ğ•ƒ))

(âŠ¨ :filter-all
   ğ•ƒ
   (âŠ² (Î» (> 0 #0)) ğ•ƒ))

; ============================================================================
; Test âŠ•â† (fold-left)
; ============================================================================

(âŠ¨ :fold-sum
   #6
   (âŠ•â† âŠ• #0 ğ•ƒ))

(âŠ¨ :fold-product
   #6
   (âŠ•â† âŠ— #1 ğ•ƒ))

(âŠ¨ :fold-empty
   #0
   (âŠ•â† âŠ• #0 âˆ…))

; ============================================================================
; Test âŠ•â†’ (fold-right)
; ============================================================================

(âŠ¨ :foldr-list-identity
   ğ•ƒ
   (âŠ•â†’ âŸ¨âŸ© ğ•ƒ âˆ…))

(âŠ¨ :foldr-sum
   #6
   (âŠ•â†’ âŠ• ğ•ƒ #0))

; ============================================================================
; Test # (length)
; ============================================================================

(âŠ¨ :length-three
   #3
   (# ğ•ƒ))

(âŠ¨ :length-empty
   #0
   (# âˆ…))

(âŠ¨ :length-one
   #1
   (# (âŸ¨âŸ© #42 âˆ…)))

; ============================================================================
; Test â§º (append)
; ============================================================================

(âŠ¨ :append-two-lists
   (âŸ¨âŸ© #1 (âŸ¨âŸ© #2 (âŸ¨âŸ© #3 (âŸ¨âŸ© #4 (âŸ¨âŸ© #5 âˆ…)))))
   (â§º (âŸ¨âŸ© #4 (âŸ¨âŸ© #5 âˆ…)) ğ•ƒ))

(âŠ¨ :append-empty-first
   ğ•ƒ
   (â§º âˆ… ğ•ƒ))

(âŠ¨ :append-empty-second
   ğ•ƒ
   (â§º ğ•ƒ âˆ…))

; ============================================================================
; Test â‡„ (reverse)
; ============================================================================

(âŠ¨ :reverse-list
   (âŸ¨âŸ© #3 (âŸ¨âŸ© #2 (âŸ¨âŸ© #1 âˆ…)))
   (â‡„ ğ•ƒ))

(âŠ¨ :reverse-empty
   âˆ…
   (â‡„ âˆ…))

(âŠ¨ :reverse-single
   (âŸ¨âŸ© #42 âˆ…)
   (â‡„ (âŸ¨âŸ© #42 âˆ…)))

; ============================================================================
; Test â†‘ (take)
; ============================================================================

(âŠ¨ :take-two
   (âŸ¨âŸ© #1 (âŸ¨âŸ© #2 âˆ…))
   (â†‘ ğ•ƒ #2))

(âŠ¨ :take-zero
   âˆ…
   (â†‘ ğ•ƒ #0))

(âŠ¨ :take-all
   ğ•ƒ
   (â†‘ ğ•ƒ #3))

(âŠ¨ :take-more-than-length
   ğ•ƒ
   (â†‘ ğ•ƒ #10))

; ============================================================================
; Test â†“ (drop)
; ============================================================================

(âŠ¨ :drop-two
   (âŸ¨âŸ© #3 âˆ…)
   (â†“ ğ•ƒ #2))

(âŠ¨ :drop-zero
   ğ•ƒ
   (â†“ ğ•ƒ #0))

(âŠ¨ :drop-all
   âˆ…
   (â†“ ğ•ƒ #3))

(âŠ¨ :drop-more-than-length
   âˆ…
   (â†“ ğ•ƒ #10))

; ============================================================================
; Test âŠ¼ (zip)
; ============================================================================

(âŠ¨ :zip-same-length
   (âŸ¨âŸ© (âŸ¨âŸ© #1 :a) (âŸ¨âŸ© (âŸ¨âŸ© #2 :b) (âŸ¨âŸ© (âŸ¨âŸ© #3 :c) âˆ…)))
   (âŠ¼ (âŸ¨âŸ© :c (âŸ¨âŸ© :b (âŸ¨âŸ© :a âˆ…))) ğ•ƒ))

(âŠ¨ :zip-first-shorter
   (âŸ¨âŸ© (âŸ¨âŸ© #1 :a) (âŸ¨âŸ© (âŸ¨âŸ© #2 :b) âˆ…))
   (âŠ¼ (âŸ¨âŸ© :d (âŸ¨âŸ© :c (âŸ¨âŸ© :b (âŸ¨âŸ© :a âˆ…)))) (âŸ¨âŸ© #1 (âŸ¨âŸ© #2 âˆ…))))

(âŠ¨ :zip-empty
   âˆ…
   (âŠ¼ âˆ… ğ•ƒ))

; ============================================================================
; Test âˆƒ (any/exists)
; ============================================================================

(âŠ¨ :any-found
   #t
   (âˆƒ (Î» (â‰¡ 0 #2)) ğ•ƒ))

(âŠ¨ :any-not-found
   #f
   (âˆƒ (Î» (â‰¡ 0 #10)) ğ•ƒ))

(âŠ¨ :any-empty
   #f
   (âˆƒ (Î» (â‰¡ 0 #1)) âˆ…))

; ============================================================================
; Test âˆ€ (all/forall)
; ============================================================================

(âŠ¨ :all-true
   #t
   (âˆ€ (Î» (> 0 #0)) ğ•ƒ))

(âŠ¨ :all-false
   #f
   (âˆ€ (Î» (â‰¡ 0 #2)) ğ•ƒ))

(âŠ¨ :all-empty
   #t
   (âˆ€ (Î» #f) âˆ…))

; ============================================================================
; Test âˆˆ (contains/member)
; ============================================================================

(âŠ¨ :contains-found
   #t
   (âˆˆ ğ•ƒ #2))

(âŠ¨ :contains-not-found
   #f
   (âˆˆ ğ•ƒ #10))

(âŠ¨ :contains-empty
   #f
   (âˆˆ âˆ… #1))

; ============================================================================
; Test â‹¯ (range)
; ============================================================================

(âŠ¨ :range-1-5
   (âŸ¨âŸ© #1 (âŸ¨âŸ© #2 (âŸ¨âŸ© #3 (âŸ¨âŸ© #4 âˆ…))))
   (â‹¯ #5 #1))

(âŠ¨ :range-empty
   âˆ…
   (â‹¯ #1 #1))

(âŠ¨ :range-backwards
   âˆ…
   (â‹¯ #1 #5))

; ============================================================================
; Test âŠšâŠš (replicate)
; ============================================================================

(âŠ¨ :replicate-three
   (âŸ¨âŸ© #42 (âŸ¨âŸ© #42 (âŸ¨âŸ© #42 âˆ…)))
   (âŠšâŠš #42 #3))

(âŠ¨ :replicate-zero
   âˆ…
   (âŠšâŠš #42 #0))

(âŠ¨ :replicate-one
   (âŸ¨âŸ© #99 âˆ…)
   (âŠšâŠš #99 #1))

; ============================================================================
; Integration Tests
; ============================================================================

(âŠ¨ :map-then-filter
   (âŸ¨âŸ© #4 (âŸ¨âŸ© #6 âˆ…))
   (âŠ² (Î» (> 0 #3)) (â†¦ (Î» (âŠ— 0 #2)) ğ•ƒ)))

(âŠ¨ :reverse-twice
   ğ•ƒ
   (â‡„ (â‡„ ğ•ƒ)))

(âŠ¨ :length-of-range
   #4
   (# (â‹¯ #5 #1)))
