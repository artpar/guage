; Division and Arithmetic Edge Cases Test Suite
; Tests division semantics and arithmetic edge cases
; Created: 2026-01-27

; =============================================================================
; SECTION 1: Basic Division Tests
; =============================================================================

; Test 1.1: Simple integer division
(⊨ (⌜ :div-simple) #42 (⊘ #84 #2))

; Test 1.2: Division resulting in integer (even division)
(⊨ (⌜ :div-even) #5 (⊘ #15 #3))

; Test 1.3: Division resulting in 1
(⊨ (⌜ :div-equals-one) #1 (⊘ #7 #7))

; Test 1.4: Division by 1
(⊨ (⌜ :div-by-one) #42 (⊘ #42 #1))

; Test 1.5: Division of smaller by larger (float result!)
(⊨ (⌜ :div-smaller-by-larger) #0.3 (⊘ #3 #10))

; Test 1.6: Zero divided by number
(⊨ (⌜ :zero-div-by-num) #0 (⊘ #0 #5))

; =============================================================================
; SECTION 2: Division by Zero (Error Cases)
; =============================================================================

; Test 2.1: Division by zero should return infinity or error
; NOTE: This might return #inf, we need to check actual behavior
; (⊨ (⌜ :div-by-zero) ⚠ (⊘ #10 #0))
; Commenting out for now - need to determine expected behavior

; =============================================================================
; SECTION 3: GCD Algorithm Test
; =============================================================================

; Test 3.1: GCD helper function (Euclidean algorithm) - NOW WITH % PRIMITIVE!
(≔ gcd (λ (a b)
  (? (≡ b #0)
     a
     (gcd b (% a b)))))

; Test GCD with various inputs
(⊨ (⌜ :gcd-48-18) #6 (gcd #48 #18))
(⊨ (⌜ :gcd-100-50) #50 (gcd #100 #50))
(⊨ (⌜ :gcd-17-13) #1 (gcd #17 #13))
(⊨ (⌜ :gcd-21-14) #7 (gcd #21 #14))

; =============================================================================
; SECTION 4: Arithmetic Edge Cases
; =============================================================================

; Test 4.1: Large number addition
(⊨ (⌜ :large-add) #2000000000 (⊕ #1000000000 #1000000000))

; Test 4.2: Large number multiplication
(⊨ (⌜ :large-mult) #1000000 (⊗ #1000 #1000))

; Test 4.3: Subtraction resulting in zero
(⊨ (⌜ :sub-to-zero) #0 (⊖ #42 #42))

; Test 4.4: Subtraction of larger from smaller (negative result)
; NOTE: Need to check if negatives are supported
(⊨ (⌜ :sub-negative) #-5 (⊖ #5 #10))

; Test 4.5: Multiplication by zero
(⊨ (⌜ :mult-by-zero) #0 (⊗ #42 #0))

; Test 4.6: Addition with zero
(⊨ (⌜ :add-zero) #42 (⊕ #42 #0))

; =============================================================================
; SECTION 5: Comparison Edge Cases
; =============================================================================

; Test 5.1: Compare with zero
(⊨ (⌜ :gt-zero) #t (> #1 #0))
(⊨ (⌜ :lt-zero) #t (< #0 #1))

; Test 5.2: Compare equal numbers
(⊨ (⌜ :eq-same) #t (≡ #42 #42))
(⊨ (⌜ :not-gt-same) #f (> #42 #42))
(⊨ (⌜ :not-lt-same) #f (< #42 #42))

; Test 5.3: Greater than or equal
(⊨ (⌜ :gte-greater) #t (≥ #10 #5))
(⊨ (⌜ :gte-equal) #t (≥ #10 #10))
(⊨ (⌜ :gte-less) #f (≥ #5 #10))

; Test 5.4: Less than or equal
(⊨ (⌜ :lte-less) #t (≤ #5 #10))
(⊨ (⌜ :lte-equal) #t (≤ #10 #10))
(⊨ (⌜ :lte-greater) #f (≤ #10 #5))

; =============================================================================
; SECTION 6: Modulo Operation (NEW PRIMITIVE!)
; =============================================================================

; Test the new % primitive
(⊨ (⌜ :mod-10-3) #1 (% #10 #3))
(⊨ (⌜ :mod-17-5) #2 (% #17 #5))
(⊨ (⌜ :mod-20-4) #0 (% #20 #4))
(⊨ (⌜ :mod-7-7) #0 (% #7 #7))

; =============================================================================
; SECTION 7: Mathematical Utility Functions
; =============================================================================

; Test 7.1: Absolute value
(≔ abs (λ (x) (? (< x #0) (⊖ #0 x) x)))
(⊨ (⌜ :abs-positive) #5 (abs #5))
(⊨ (⌜ :abs-negative) #5 (abs #-5))
(⊨ (⌜ :abs-zero) #0 (abs #0))

; Test 7.2: Minimum
(≔ min (λ (a b) (? (< a b) a b)))
(⊨ (⌜ :min-first-smaller) #3 (min #3 #7))
(⊨ (⌜ :min-second-smaller) #3 (min #7 #3))
(⊨ (⌜ :min-equal) #5 (min #5 #5))

; Test 7.3: Maximum
(≔ max (λ (a b) (? (> a b) a b)))
(⊨ (⌜ :max-first-larger) #7 (max #7 #3))
(⊨ (⌜ :max-second-larger) #7 (max #3 #7))
(⊨ (⌜ :max-equal) #5 (max #5 #5))

; Test 7.4: Power function (simple, only positive integer exponents)
(≔ pow (λ (base exp)
  (? (≡ exp #0)
     #1
     (⊗ base (pow base (⊖ exp #1))))))

(⊨ (⌜ :pow-2-3) #8 (pow #2 #3))
(⊨ (⌜ :pow-3-4) #81 (pow #3 #4))
(⊨ (⌜ :pow-5-0) #1 (pow #5 #0))
(⊨ (⌜ :pow-10-2) #100 (pow #10 #2))

; =============================================================================
; Summary: 40+ tests for division and arithmetic
; =============================================================================
