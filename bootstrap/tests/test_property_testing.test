; Test file for property-based testing primitives
; Tests generators, property tests, and shrinking

; ============ Helper: List Length ============
(‚âî len (Œª (lst)
  (? (‚àÖ? lst)
     #0
     (‚äï #1 (len (‚ñ∑ lst))))))

; ============ Generator Tests ============

; Test gen-int returns number in range [1, 10]
(‚âî test-gen-int (gen-int #1 #10))
(‚ä® :gen-int-is-number #t (‚Ñï? test-gen-int))
(‚ä® :gen-int-in-range #t (‚àß (‚â• test-gen-int #1) (‚â§ test-gen-int #10)))

; Test gen-int with single value range
(‚ä® :gen-int-single #5 (gen-int #5 #5))

; Test gen-int error on invalid range
(‚ä® :gen-int-invalid-range #t (‚ö†? (gen-int #10 #1)))

; Test gen-bool returns boolean
(‚ä® :gen-bool-returns-bool #t (ùîπ? (gen-bool)))

; Test gen-symbol from list
(‚âî test-symbols (‚ü®‚ü© :a (‚ü®‚ü© :b (‚ü®‚ü© :c ‚àÖ))))
(‚âî test-result (gen-symbol test-symbols))
(‚ä® :gen-symbol-in-list #t
   (‚à® (‚à® (‚â° test-result :a) (‚â° test-result :b)) (‚â° test-result :c)))

; Test gen-symbol error on empty list
(‚ä® :gen-symbol-empty #t (‚ö†? (gen-symbol ‚àÖ)))

; Test gen-list with constant generator
(‚âî const-gen (Œª () #42))
(‚âî const-list (gen-list const-gen #5))
(‚ä® :gen-list-constant #5 (len const-list))

; Test gen-list with zero size
(‚âî zero-gen (Œª () #1))
(‚ä® :gen-list-zero ‚àÖ (gen-list zero-gen #0))

; Test gen-list with random integers
(‚âî int-gen (Œª () (gen-int #1 #100)))
(‚âî int-list (gen-list int-gen #10))
(‚ä® :gen-list-integers #10 (len int-list))

; ============ Property-Based Test Tests ============

; Simple property: all generated numbers are positive
(‚ä®-prop :all-positive
        (Œª (n) (> n #0))
        (Œª () (gen-int #1 #100)))

; Property: list length matches requested size
(‚ä®-prop :list-length-correct
        (Œª (lst) (‚â° (len lst) #5))
        (Œª () (gen-list (Œª () (gen-int #1 #10)) #5)))

; Property: boolean is always true or false
(‚ä®-prop :bool-valid
        (Œª (b) (‚à® (‚â° b #t) (‚â° b #f)))
        (Œª () (gen-bool)))

; Property: generated integer is in range
(‚ä®-prop :int-in-range
        (Œª (n) (‚àß (‚â• n #-10) (‚â§ n #10)))
        (Œª () (gen-int #-10 #10)))

; Property: list length is preserved (simpler test without reverse)
(‚âî count (Œª (lst)
  (? (‚àÖ? lst)
     #0
     (‚äï #1 (count (‚ñ∑ lst))))))

(‚ä®-prop :list-length-preserved
        (Œª (lst) (‚â° (len lst) (count lst)))
        (Œª () (gen-list (Œª () (gen-int #1 #10)) #5)))

