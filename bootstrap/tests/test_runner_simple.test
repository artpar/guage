; Simplified Test Runner - Test execution logic only

; Helper functions
(define length (lambda (lst)
  (if (null? lst)
     #0
     (+ #1 (length (cdr lst))))))

; Execute a single test
(define execute-test (lambda (test)
  (if (null? test)
     ⟨:error :empty-test⟩
     (define test-sym (car test))
     (define name (car (cdr test)))
     (define expected (car (cdr (cdr test))))
     (define actual (car (cdr (cdr (cdr test)))))
     (if (deep-equal? expected actual)
        ⟨:pass name⟩
        ⟨:fail name expected actual⟩))))

; Test with single primitive
trace :testing-single-primitive
(define add-tests (doc-tests (quote +)))
trace :tests-generated
trace add-tests
(define result (execute-test (car add-tests)))
trace :test-result
result
