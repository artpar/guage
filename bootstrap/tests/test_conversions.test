#!/usr/bin/env guage
; Test suite for string conversion primitives
; string->number (string-to-number) and string->symbol (string-to-symbol)

(print "Testing String Conversion Primitives...")

; ============================================================================
; string->number — String to Number
; ============================================================================

(print "\nTesting string->number (string-to-number)...")

; Integer conversions
(test-case :str-to-num-int
   #42
   (string->number "42"))

(test-case :str-to-num-zero
   #0
   (string->number "0"))

(test-case :str-to-num-negative
   #-7
   (string->number "-7"))

; Float conversions
(test-case :str-to-num-float
   #3.14
   (string->number "3.14"))

(test-case :str-to-num-neg-float
   #-0.5
   (string->number "-0.5"))

; Scientific notation
(test-case :str-to-num-sci
   #1000
   (string->number "1e3"))

; Invalid strings return error
(test-case :str-to-num-invalid
   #t
   (error? (string->number "abc")))

(test-case :str-to-num-empty
   #t
   (error? (string->number "")))

(test-case :str-to-num-partial
   #t
   (error? (string->number "42abc")))

; Arithmetic on converted numbers
(test-case :str-to-num-arithmetic
   #10
   (+ (string->number "3") (string->number "7")))

; ============================================================================
; string->symbol — String to Symbol
; ============================================================================

(print "\nTesting string->symbol (string-to-symbol)...")

; Basic conversion
(test-case :str-to-sym-basic
   #t
   (symbol? (string->symbol "hello")))

(test-case :str-to-sym-eq
   #t
   (equal? (string->symbol "hello") (quote hello)))

; Unicode symbol
(test-case :str-to-sym-unicode
   #t
   (symbol? (string->symbol "λ")))

; Symbol predicate on result
(test-case :str-to-sym-predicate
   #t
   (symbol? (string->symbol "test-name")))

; Round-trip: symbol -> string -> symbol
(test-case :str-to-sym-roundtrip
   #t
   (equal? (string->symbol (string (quote foo))) (quote foo)))

(print "\nAll conversion tests complete.")
