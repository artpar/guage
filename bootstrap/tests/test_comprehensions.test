; â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
; Test Suite: List Comprehensions
; â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
; Status: CURRENT
; Created: 2026-01-27 (Day 35)
; Purpose: Comprehensive tests for stdlib/comprehensions.scm
; â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

; Load required modules
(â‹˜ "bootstrap/stdlib/list.scm")
(â‹˜ "bootstrap/stdlib/macros.scm")
(â‹˜ "bootstrap/stdlib/comprehensions.scm")

; â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
; Phase 1: Range Generation Tests
; â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

; Test 1: Basic range (inclusive)
(âŠ¨ :test-range-basic
   (âŸ¨âŸ© #1 (âŸ¨âŸ© #2 (âŸ¨âŸ© #3 (âŸ¨âŸ© #4 (âŸ¨âŸ© #5 âˆ…)))))
   (â‹¯â†’ #1 #5))

; Test 2: Single element range
(âŠ¨ :test-range-single
   (âŸ¨âŸ© #3 âˆ…)
   (â‹¯â†’ #3 #3))

; Test 3: Empty range (start > end)
(âŠ¨ :test-range-empty
   âˆ…
   (â‹¯â†’ #5 #1))

; Test 4: Longer range
(âŠ¨ :test-range-longer
   (âŸ¨âŸ© #1 (âŸ¨âŸ© #2 (âŸ¨âŸ© #3 (âŸ¨âŸ© #4 (âŸ¨âŸ© #5 (âŸ¨âŸ© #6 (âŸ¨âŸ© #7 (âŸ¨âŸ© #8 (âŸ¨âŸ© #9 (âŸ¨âŸ© #10 âˆ…))))))))))
   (â‹¯â†’ #1 #10))

; Test 5: Range starting from 0
(âŠ¨ :test-range-zero
   (âŸ¨âŸ© #0 (âŸ¨âŸ© #1 (âŸ¨âŸ© #2 âˆ…)))
   (â‹¯â†’ #0 #2))

; Test 6: Range with step (custom increment)
(âŠ¨ :test-range-step-2
   (âŸ¨âŸ© #1 (âŸ¨âŸ© #3 (âŸ¨âŸ© #5 (âŸ¨âŸ© #7 (âŸ¨âŸ© #9 âˆ…)))))
   (â‹° #1 #10 #2))

; Test 7: Range with step 3
(âŠ¨ :test-range-step-3
   (âŸ¨âŸ© #0 (âŸ¨âŸ© #3 (âŸ¨âŸ© #6 (âŸ¨âŸ© #9 âˆ…))))
   (â‹° #0 #10 #3))

; â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
; Phase 2: Basic Comprehension Tests (Map, Filter)
; â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

; Test 8: Map - double each element
(âŠ¨ :test-comp-map-double
   (âŸ¨âŸ© #2 (âŸ¨âŸ© #4 (âŸ¨âŸ© #6 (âŸ¨âŸ© #8 (âŸ¨âŸ© #10 âˆ…)))))
   ((âŠ¡â†¦ (Î» (ğ•©) (âŠ— ğ•© #2))) (â‹¯â†’ #1 #5)))

; Test 9: Map - square each element
(âŠ¨ :test-comp-map-square
   (âŸ¨âŸ© #1 (âŸ¨âŸ© #4 (âŸ¨âŸ© #9 (âŸ¨âŸ© #16 (âŸ¨âŸ© #25 âˆ…)))))
   ((âŠ¡â†¦ (Î» (ğ•©) (âŠ— ğ•© ğ•©))) (â‹¯â†’ #1 #5)))

; Test 10: Filter - even numbers
(âŠ¨ :test-comp-filter-even
   (âŸ¨âŸ© #2 (âŸ¨âŸ© #4 (âŸ¨âŸ© #6 (âŸ¨âŸ© #8 (âŸ¨âŸ© #10 âˆ…)))))
   ((âŠ¡âŠ² (Î» (ğ•©) (â‰¡ (% ğ•© #2) #0))) (â‹¯â†’ #1 #10)))

; Test 11: Filter - greater than 5
(âŠ¨ :test-comp-filter-gt
   (âŸ¨âŸ© #6 (âŸ¨âŸ© #7 (âŸ¨âŸ© #8 (âŸ¨âŸ© #9 (âŸ¨âŸ© #10 âˆ…)))))
   ((âŠ¡âŠ² (Î» (ğ•©) (> ğ•© #5))) (â‹¯â†’ #1 #10)))

; Test 12: Filter then map - squares of evens
(âŠ¨ :test-comp-filter-map
   (âŸ¨âŸ© #4 (âŸ¨âŸ© #16 (âŸ¨âŸ© #36 (âŸ¨âŸ© #64 (âŸ¨âŸ© #100 âˆ…)))))
   (âŠ¡âŠ²â†¦ (Î» (ğ•©) (â‰¡ (% ğ•© #2) #0)) (Î» (ğ•©) (âŠ— ğ•© ğ•©)) (â‹¯â†’ #1 #10)))

; Test 13: Filter then map - double odd numbers
(âŠ¨ :test-comp-filter-map-odd
   (âŸ¨âŸ© #2 (âŸ¨âŸ© #6 (âŸ¨âŸ© #10 (âŸ¨âŸ© #14 (âŸ¨âŸ© #18 âˆ…)))))
   (âŠ¡âŠ²â†¦ (Î» (ğ•©) (â‰¡ (% ğ•© #2) #1)) (Î» (ğ•©) (âŠ— ğ•© #2)) (â‹¯â†’ #1 #10)))

; Test 14: Filter empty result
(âŠ¨ :test-comp-filter-empty
   âˆ…
   ((âŠ¡âŠ² (Î» (ğ•©) (> ğ•© #100))) (â‹¯â†’ #1 #10)))

; â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
; Phase 3: Advanced Comprehension Tests
; â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

; Test 15: Cartesian product 2x2
(âŠ¨ :test-comp-cartesian-2x2
   (âŸ¨âŸ© (âŸ¨âŸ© #1 #3) (âŸ¨âŸ© (âŸ¨âŸ© #1 #4) (âŸ¨âŸ© (âŸ¨âŸ© #2 #3) (âŸ¨âŸ© (âŸ¨âŸ© #2 #4) âˆ…))))
   ((âŠ¡âŠ› (â‹¯â†’ #1 #2)) (â‹¯â†’ #3 #4)))

; Test 16: Cartesian product 3x2
(âŠ¨ :test-comp-cartesian-3x2
   (âŸ¨âŸ© (âŸ¨âŸ© #1 #4) (âŸ¨âŸ© (âŸ¨âŸ© #1 #5) (âŸ¨âŸ© (âŸ¨âŸ© #2 #4) (âŸ¨âŸ© (âŸ¨âŸ© #2 #5) (âŸ¨âŸ© (âŸ¨âŸ© #3 #4) (âŸ¨âŸ© (âŸ¨âŸ© #3 #5) âˆ…))))))
   ((âŠ¡âŠ› (â‹¯â†’ #1 #3)) (â‹¯â†’ #4 #5)))

; Test 17: Accumulator - sum
(âŠ¨ :test-comp-sum
   #55
   (((âŠ¡âŠ• âŠ•) #0) (â‹¯â†’ #1 #10)))

; Test 18: Accumulator - factorial
(âŠ¨ :test-comp-factorial
   #120
   (((âŠ¡âŠ• âŠ—) #1) (â‹¯â†’ #1 #5)))

; Test 19: Accumulator - count elements
(âŠ¨ :test-comp-count
   #10
   (((âŠ¡âŠ• (Î» (ğ•’ _) (âŠ• ğ•’ #1))) #0) (â‹¯â†’ #1 #10)))

; â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
; Phase 4: Macro-Based Comprehension Tests
; â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

; Test 20: Macro map over range
(âŠ¨ :test-macro-map-range
   (âŸ¨âŸ© #2 (âŸ¨âŸ© #4 (âŸ¨âŸ© #6 (âŸ¨âŸ© #8 (âŸ¨âŸ© #10 âˆ…)))))
   (âŠ¡â†¦â†’ #1 #5 (Î» (ğ•©) (âŠ— ğ•© #2))))

; Test 21: Macro map - squares
(âŠ¨ :test-macro-map-square
   (âŸ¨âŸ© #1 (âŸ¨âŸ© #4 (âŸ¨âŸ© #9 (âŸ¨âŸ© #16 (âŸ¨âŸ© #25 âˆ…)))))
   (âŠ¡â†¦â†’ #1 #5 (Î» (ğ•©) (âŠ— ğ•© ğ•©))))

; Test 22: Macro filter - evens
(âŠ¨ :test-macro-filter-even
   (âŸ¨âŸ© #2 (âŸ¨âŸ© #4 (âŸ¨âŸ© #6 (âŸ¨âŸ© #8 (âŸ¨âŸ© #10 âˆ…)))))
   (âŠ¡âŠ²â†’ #1 #10 (Î» (ğ•©) (â‰¡ (% ğ•© #2) #0))))

; Test 23: Macro filter and map
(âŠ¨ :test-macro-filter-map
   (âŸ¨âŸ© #4 (âŸ¨âŸ© #16 (âŸ¨âŸ© #36 (âŸ¨âŸ© #64 (âŸ¨âŸ© #100 âˆ…)))))
   (âŠ¡âŠ²â†¦â†’ #1 #10 (Î» (ğ•©) (â‰¡ (% ğ•© #2) #0)) (Î» (ğ•©) (âŠ— ğ•© ğ•©))))

; Test 24: Macro filter - odds doubled
(âŠ¨ :test-macro-filter-odd-double
   (âŸ¨âŸ© #2 (âŸ¨âŸ© #6 (âŸ¨âŸ© #10 (âŸ¨âŸ© #14 (âŸ¨âŸ© #18 âˆ…)))))
   (âŠ¡âŠ²â†¦â†’ #1 #10 (Î» (ğ•©) (â‰¡ (% ğ•© #2) #1)) (Î» (ğ•©) (âŠ— ğ•© #2))))

; Test 25: Macro map with addition
(âŠ¨ :test-macro-map-add
   (âŸ¨âŸ© #11 (âŸ¨âŸ© #12 (âŸ¨âŸ© #13 (âŸ¨âŸ© #14 (âŸ¨âŸ© #15 âˆ…)))))
   (âŠ¡â†¦â†’ #1 #5 (Î» (ğ•©) (âŠ• ğ•© #10))))

; â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
; Phase 5: Integration Tests (Real-World Examples)
; â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

; Test 26: Sum of squares (1Â² + 2Â² + 3Â² + 4Â² + 5Â² = 55)
(âŠ¨ :test-sum-of-squares
   #55
   (((âŠ¡âŠ• âŠ•) #0) ((âŠ¡â†¦ (Î» (ğ•©) (âŠ— ğ•© ğ•©))) (â‹¯â†’ #1 #5))))

; Test 27: Product of evens (2 * 4 * 6 * 8 * 10 = 3840)
(âŠ¨ :test-product-evens
   #3840
   (((âŠ¡âŠ• âŠ—) #1) ((âŠ¡âŠ² (Î» (ğ•©) (â‰¡ (% ğ•© #2) #0))) (â‹¯â†’ #1 #10))))

; Test 28: Count evens
(âŠ¨ :test-count-evens
   #5
   (((âŠ¡âŠ• (Î» (ğ•’ _) (âŠ• ğ•’ #1))) #0) ((âŠ¡âŠ² (Î» (ğ•©) (â‰¡ (% ğ•© #2) #0))) (â‹¯â†’ #1 #10))))

"âœ“ 28 list comprehension tests complete!"
