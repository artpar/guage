; Medium test - 20 tests
(load "bootstrap/stdlib/list.scm")

(test-case :unzip-basic
   (cons (cons #1 (cons #3 nil)) (cons #2 (cons #4 nil)))
   (⊽ (cons (cons #1 #2) (cons (cons #3 #4) nil))))

(test-case :unzip-single
   (cons (cons #1 nil) (cons #2 nil))
   (⊽ (cons (cons #1 #2) nil)))

(test-case :unzip-empty
   (cons nil nil)
   (⊽ nil))

(test-case :transpose-2x2
   (cons (cons #1 (cons #3 nil)) (cons (cons #2 (cons #4 nil)) nil))
   (⊤⊥ (cons (cons #1 (cons #2 nil)) (cons (cons #3 (cons #4 nil)) nil))))

(test-case :transpose-3x2
   (cons (cons #1 (cons #4 nil)) (cons (cons #2 (cons #5 nil)) (cons (cons #3 (cons #6 nil)) nil)))
   (⊤⊥ (cons (cons #1 (cons #2 (cons #3 nil))) (cons (cons #4 (cons #5 (cons #6 nil))) nil))))

(test-case :transpose-empty
   nil
   (⊤⊥ nil))

(test-case :flatten-basic
   (cons #1 (cons #2 (cons #3 nil)))
   (deque (cons (cons #1 (cons #2 nil)) (cons (cons #3 nil) nil))))

(test-case :flatten-single
   (cons #1 (cons #2 nil))
   (deque (cons (cons #1 (cons #2 nil)) nil)))

(test-case :flatten-empty
   nil
   (deque nil))

(test-case :flatten-mixed
   (cons #1 (cons #2 (cons #3 (cons #4 nil))))
   (deque (cons (cons #1 (cons #2 nil)) (cons (cons #3 (cons #4 nil)) nil))))

(test-case :flatmap-basic
   (cons #1 (cons #1 (cons #2 (cons #2 (cons #3 (cons #3 nil))))))
   ((↦⊟ (lambda (x) (cons x (cons x nil)))) (cons #1 (cons #2 (cons #3 nil)))))

(test-case :flatmap-empty
   nil
   ((↦⊟ (lambda (x) (cons x (cons x nil)))) nil))

(test-case :takewhile-basic
   (cons #1 (cons #2 nil))
   ((↑? (lambda (x) (< x #5))) (cons #1 (cons #2 (cons #10 nil)))))

(test-case :takewhile-all
   (cons #1 (cons #2 (cons #3 nil)))
   ((↑? (lambda (x) (< x #10))) (cons #1 (cons #2 (cons #3 nil)))))

(test-case :takewhile-none
   nil
   ((↑? (lambda (x) (< x #0))) (cons #1 (cons #2 (cons #3 nil)))))

(test-case :takewhile-empty
   nil
   ((↑? (lambda (x) (< x #5))) nil))

(test-case :dropwhile-basic
   (cons #7 (cons #8 nil))
   ((↓? (lambda (x) (< x #5))) (cons #1 (cons #2 (cons #7 (cons #8 nil))))))

(test-case :dropwhile-all
   nil
   ((↓? (lambda (x) (< x #10))) (cons #1 (cons #2 (cons #3 nil)))))

(test-case :dropwhile-none
   (cons #1 (cons #2 (cons #3 nil)))
   ((↓? (lambda (x) (< x #0))) (cons #1 (cons #2 (cons #3 nil)))))

(test-case :dropwhile-empty
   nil
   ((↓? (lambda (x) (< x #5))) nil))
