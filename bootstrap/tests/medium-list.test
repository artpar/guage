; Medium test - 20 tests
(⋘ "bootstrap/stdlib/list.scm")

(⊨ :unzip-basic
   (⟨⟩ (⟨⟩ #1 (⟨⟩ #3 ∅)) (⟨⟩ #2 (⟨⟩ #4 ∅)))
   (⊽ (⟨⟩ (⟨⟩ #1 #2) (⟨⟩ (⟨⟩ #3 #4) ∅))))

(⊨ :unzip-single
   (⟨⟩ (⟨⟩ #1 ∅) (⟨⟩ #2 ∅))
   (⊽ (⟨⟩ (⟨⟩ #1 #2) ∅)))

(⊨ :unzip-empty
   (⟨⟩ ∅ ∅)
   (⊽ ∅))

(⊨ :transpose-2x2
   (⟨⟩ (⟨⟩ #1 (⟨⟩ #3 ∅)) (⟨⟩ (⟨⟩ #2 (⟨⟩ #4 ∅)) ∅))
   (⊤⊥ (⟨⟩ (⟨⟩ #1 (⟨⟩ #2 ∅)) (⟨⟩ (⟨⟩ #3 (⟨⟩ #4 ∅)) ∅))))

(⊨ :transpose-3x2
   (⟨⟩ (⟨⟩ #1 (⟨⟩ #4 ∅)) (⟨⟩ (⟨⟩ #2 (⟨⟩ #5 ∅)) (⟨⟩ (⟨⟩ #3 (⟨⟩ #6 ∅)) ∅)))
   (⊤⊥ (⟨⟩ (⟨⟩ #1 (⟨⟩ #2 (⟨⟩ #3 ∅))) (⟨⟩ (⟨⟩ #4 (⟨⟩ #5 (⟨⟩ #6 ∅))) ∅))))

(⊨ :transpose-empty
   ∅
   (⊤⊥ ∅))

(⊨ :flatten-basic
   (⟨⟩ #1 (⟨⟩ #2 (⟨⟩ #3 ∅)))
   (⊟ (⟨⟩ (⟨⟩ #1 (⟨⟩ #2 ∅)) (⟨⟩ (⟨⟩ #3 ∅) ∅))))

(⊨ :flatten-single
   (⟨⟩ #1 (⟨⟩ #2 ∅))
   (⊟ (⟨⟩ (⟨⟩ #1 (⟨⟩ #2 ∅)) ∅)))

(⊨ :flatten-empty
   ∅
   (⊟ ∅))

(⊨ :flatten-mixed
   (⟨⟩ #1 (⟨⟩ #2 (⟨⟩ #3 (⟨⟩ #4 ∅))))
   (⊟ (⟨⟩ (⟨⟩ #1 (⟨⟩ #2 ∅)) (⟨⟩ (⟨⟩ #3 (⟨⟩ #4 ∅)) ∅))))

(⊨ :flatmap-basic
   (⟨⟩ #1 (⟨⟩ #1 (⟨⟩ #2 (⟨⟩ #2 (⟨⟩ #3 (⟨⟩ #3 ∅))))))
   ((↦⊟ (λ (x) (⟨⟩ x (⟨⟩ x ∅)))) (⟨⟩ #1 (⟨⟩ #2 (⟨⟩ #3 ∅)))))

(⊨ :flatmap-empty
   ∅
   ((↦⊟ (λ (x) (⟨⟩ x (⟨⟩ x ∅)))) ∅))

(⊨ :takewhile-basic
   (⟨⟩ #1 (⟨⟩ #2 ∅))
   ((↑? (λ (x) (< x #5))) (⟨⟩ #1 (⟨⟩ #2 (⟨⟩ #10 ∅)))))

(⊨ :takewhile-all
   (⟨⟩ #1 (⟨⟩ #2 (⟨⟩ #3 ∅)))
   ((↑? (λ (x) (< x #10))) (⟨⟩ #1 (⟨⟩ #2 (⟨⟩ #3 ∅)))))

(⊨ :takewhile-none
   ∅
   ((↑? (λ (x) (< x #0))) (⟨⟩ #1 (⟨⟩ #2 (⟨⟩ #3 ∅)))))

(⊨ :takewhile-empty
   ∅
   ((↑? (λ (x) (< x #5))) ∅))

(⊨ :dropwhile-basic
   (⟨⟩ #7 (⟨⟩ #8 ∅))
   ((↓? (λ (x) (< x #5))) (⟨⟩ #1 (⟨⟩ #2 (⟨⟩ #7 (⟨⟩ #8 ∅))))))

(⊨ :dropwhile-all
   ∅
   ((↓? (λ (x) (< x #10))) (⟨⟩ #1 (⟨⟩ #2 (⟨⟩ #3 ∅)))))

(⊨ :dropwhile-none
   (⟨⟩ #1 (⟨⟩ #2 (⟨⟩ #3 ∅)))
   ((↓? (λ (x) (< x #0))) (⟨⟩ #1 (⟨⟩ #2 (⟨⟩ #3 ∅)))))

(⊨ :dropwhile-empty
   ∅
   ((↓? (λ (x) (< x #5))) ∅))
