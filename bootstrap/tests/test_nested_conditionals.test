;;;
;;; Test nested conditionals like in special-form?
;;;

;;; Test 1: Simple conditional in lambda
(define test1 (lambda (x) (if (null? x) #f #t)))
(print :test1)
(print (test1 nil))
(print (test1 #42))

;;; Test 2: Nested conditional
(define test2 (lambda (x)
  (if (null? x)
     #f
     (if (equal? x #42)
        #t
        #f))))
(print :test2)
(print (test2 nil))
(print (test2 #42))
(print (test2 #99))

;;; Test 3: Conditional with car
(define test3 (lambda (x)
  (if (null? x)
     #f
     (equal? (car x) :a))))
(print :test3)
(print (test3 nil))
(define list-a (quote (a b c)))
(print (test3 list-a))

;;; Test 4: Exact pattern from special-form?
(define test4 (lambda (expr)
  (if (null? expr)
     #f
     (equal? (car expr) :lambda))))
(print :test4)
(print (test4 nil))
(define lambda-expr (quote (lambda (:x) :x)))
(print lambda-expr)
(print (test4 lambda-expr))
