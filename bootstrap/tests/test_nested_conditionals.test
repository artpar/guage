;;;
;;; Test nested conditionals like in special-form?
;;;

;;; Test 1: Simple conditional in lambda
(≔ test1 (λ (x) (? (∅? x) #f #t)))
(≋ :test1)
(≋ (test1 ∅))
(≋ (test1 #42))

;;; Test 2: Nested conditional
(≔ test2 (λ (x)
  (? (∅? x)
     #f
     (? (≡ x #42)
        #t
        #f))))
(≋ :test2)
(≋ (test2 ∅))
(≋ (test2 #42))
(≋ (test2 #99))

;;; Test 3: Conditional with car
(≔ test3 (λ (x)
  (? (∅? x)
     #f
     (≡ (◁ x) :a))))
(≋ :test3)
(≋ (test3 ∅))
(≔ list-a (⌜ (a b c)))
(≋ (test3 list-a))

;;; Test 4: Exact pattern from special-form?
(≔ test4 (λ (expr)
  (? (∅? expr)
     #f
     (≡ (◁ expr) :λ))))
(≋ :test4)
(≋ (test4 ∅))
(≔ lambda-expr (⌜ (λ (:x) :x)))
(≋ lambda-expr)
(≋ (test4 lambda-expr))
