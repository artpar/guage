; Basic functionality tests

; Identity function
(define id (lambda (x) x))
(assert (deep-equal? (id #42) #42) :identity)

; Const function
(define const (lambda (x) (lambda (y) x)))
(assert (deep-equal? ((const #10) #20) #10) :const)

; Addition
(assert (deep-equal? (+ #2 #3) #5) :add)

; Nested lambda
(define add1 (lambda (x) (+ x #1)))
(assert (deep-equal? (add1 #41) #42) :lambda-with-prim)

; Type introspection
(assert (deep-equal? (struct-create #42) :number) :typeof)
(assert (deep-equal? (struct-create id) :lambda) :typeof-lambda)

; Arity
(define f2 (lambda (x y) (+ x y)))
(assert (deep-equal? (arity f2) #2) :arity)
