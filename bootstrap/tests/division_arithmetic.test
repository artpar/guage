; Division and Arithmetic Edge Cases Test Suite
; Tests division semantics and arithmetic edge cases
; Created: 2026-01-27

; =============================================================================
; SECTION 1: Basic Division Tests
; =============================================================================

; Test 1.1: Simple integer division
(test-case (quote :div-simple) #42 (/ #84 #2))

; Test 1.2: Division resulting in integer (even division)
(test-case (quote :div-even) #5 (/ #15 #3))

; Test 1.3: Division resulting in 1
(test-case (quote :div-equals-one) #1 (/ #7 #7))

; Test 1.4: Division by 1
(test-case (quote :div-by-one) #42 (/ #42 #1))

; Test 1.5: Division of smaller by larger (float result!)
(test-case (quote :div-smaller-by-larger) #0.3 (/ #3 #10))

; Test 1.6: Zero divided by number
(test-case (quote :zero-div-by-num) #0 (/ #0 #5))

; =============================================================================
; SECTION 2: Division by Zero (Error Cases)
; =============================================================================

; Test 2.1: Division by zero should return infinity or error
; NOTE: This might return #inf, we need to check actual behavior
; (test-case (quote :div-by-zero) error (/ #10 #0))
; Commenting out for now - need to determine expected behavior

; =============================================================================
; SECTION 3: GCD Algorithm Test
; =============================================================================

; Test 3.1: GCD helper function (Euclidean algorithm) - NOW WITH % PRIMITIVE!
(define gcd (lambda (a b)
  (if (equal? b #0)
     a
     (gcd b (% a b)))))

; Test GCD with various inputs
(test-case (quote :gcd-48-18) #6 (gcd #48 #18))
(test-case (quote :gcd-100-50) #50 (gcd #100 #50))
(test-case (quote :gcd-17-13) #1 (gcd #17 #13))
(test-case (quote :gcd-21-14) #7 (gcd #21 #14))

; =============================================================================
; SECTION 4: Arithmetic Edge Cases
; =============================================================================

; Test 4.1: Large number addition
(test-case (quote :large-add) #2000000000 (+ #1000000000 #1000000000))

; Test 4.2: Large number multiplication
(test-case (quote :large-mult) #1000000 (* #1000 #1000))

; Test 4.3: Subtraction resulting in zero
(test-case (quote :sub-to-zero) #0 (- #42 #42))

; Test 4.4: Subtraction of larger from smaller (negative result)
; NOTE: Need to check if negatives are supported
(test-case (quote :sub-negative) #-5 (- #5 #10))

; Test 4.5: Multiplication by zero
(test-case (quote :mult-by-zero) #0 (* #42 #0))

; Test 4.6: Addition with zero
(test-case (quote :add-zero) #42 (+ #42 #0))

; =============================================================================
; SECTION 5: Comparison Edge Cases
; =============================================================================

; Test 5.1: Compare with zero
(test-case (quote :gt-zero) #t (> #1 #0))
(test-case (quote :lt-zero) #t (< #0 #1))

; Test 5.2: Compare equal numbers
(test-case (quote :eq-same) #t (equal? #42 #42))
(test-case (quote :not-gt-same) #f (> #42 #42))
(test-case (quote :not-lt-same) #f (< #42 #42))

; Test 5.3: Greater than or equal
(test-case (quote :gte-greater) #t (>= #10 #5))
(test-case (quote :gte-equal) #t (>= #10 #10))
(test-case (quote :gte-less) #f (>= #5 #10))

; Test 5.4: Less than or equal
(test-case (quote :lte-less) #t (<= #5 #10))
(test-case (quote :lte-equal) #t (<= #10 #10))
(test-case (quote :lte-greater) #f (<= #10 #5))

; =============================================================================
; SECTION 6: Modulo Operation (NEW PRIMITIVE!)
; =============================================================================

; Test the new % primitive
(test-case (quote :mod-10-3) #1 (% #10 #3))
(test-case (quote :mod-17-5) #2 (% #17 #5))
(test-case (quote :mod-20-4) #0 (% #20 #4))
(test-case (quote :mod-7-7) #0 (% #7 #7))

; =============================================================================
; SECTION 7: Mathematical Utility Functions
; =============================================================================

; Test 7.1: Absolute value
(define abs (lambda (x) (if (< x #0) (- #0 x) x)))
(test-case (quote :abs-positive) #5 (abs #5))
(test-case (quote :abs-negative) #5 (abs #-5))
(test-case (quote :abs-zero) #0 (abs #0))

; Test 7.2: Minimum
(define min (lambda (a b) (if (< a b) a b)))
(test-case (quote :min-first-smaller) #3 (min #3 #7))
(test-case (quote :min-second-smaller) #3 (min #7 #3))
(test-case (quote :min-equal) #5 (min #5 #5))

; Test 7.3: Maximum
(define max (lambda (a b) (if (> a b) a b)))
(test-case (quote :max-first-larger) #7 (max #7 #3))
(test-case (quote :max-second-larger) #7 (max #3 #7))
(test-case (quote :max-equal) #5 (max #5 #5))

; Test 7.4: Power function (simple, only positive integer exponents)
(define pow (lambda (base exp)
  (if (equal? exp #0)
     #1
     (* base (pow base (- exp #1))))))

(test-case (quote :pow-2-3) #8 (pow #2 #3))
(test-case (quote :pow-3-4) #81 (pow #3 #4))
(test-case (quote :pow-5-0) #1 (pow #5 #0))
(test-case (quote :pow-10-2) #100 (pow #10 #2))

; =============================================================================
; Summary: 40+ tests for division and arithmetic
; =============================================================================
