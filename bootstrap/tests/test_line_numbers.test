; Test suite for source introspection (source)
; Verifies that source returns lambda body correctly

(print "Testing Source Introspection...")

; Lambda source retrieval
(define my-fn (lambda (x) (+ x #1)))

; source returns the body of a lambda
(test-case :lambda-source-is-pair
   #t
   (pair? (source my-fn)))

; source on non-lambda returns error
(test-case :source-non-lambda-error
   #t
   (error? (source #42)))

(print "\nSource introspection tests complete.")
