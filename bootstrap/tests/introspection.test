; Introspection Tests

; Note: struct-create symbol is now used for structure primitives (Phase 2C)
; Type-of tests disabled - type introspection moved to separate primitive (future)
; (test-case (quote :typeof-number) :number (struct-create #42))
; (test-case (quote :typeof-bool) :bool (struct-create #t))
; (test-case (quote :typeof-nil) :nil (struct-create nil))

; Lambda introspection
(define f1 (lambda (x) x))
(define f2 (lambda (x y) (+ x y)))
(define f3 (lambda (a b c) (* a (+ b c))))

; (test-case (quote :typeof-lambda) :lambda (struct-create f1))
(test-case (quote :arity-1) #1 (arity f1))
(test-case (quote :arity-2) #2 (arity f2))
(test-case (quote :arity-3) #3 (arity f3))

; Deep equality
(test-case (quote :eq-numbers) #t (deep-equal? #42 #42))
(test-case (quote :eq-bools) #t (deep-equal? #t #t))
(test-case (quote :neq-numbers) #f (deep-equal? #42 #43))
