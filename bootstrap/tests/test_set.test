; Test: HashSet (set) â€” Boost-style groups-of-15 + overflow Bloom byte
; Day 110

(test-case (quote :set-create-empty) #0 (set-size (set)))

(test-case (quote :set-create-values) #3 (set-size (set #1 #2 #3)))

(define s1 (set :a :b :c))
(test-case (quote :set-has-member) #t (and (set-has? s1 :a) (not (set-has? s1 :z))))

(define s2 (set))
(set-add s2 :x)
(test-case (quote :set-add-new) #t (set-has? s2 :x))

(define s3 (set :d))
(set-add s3 :d)
(test-case (quote :set-add-duplicate) #1 (set-size s3))

(define s4 (set :r :s))
(set-remove s4 :r)
(test-case (quote :set-remove) #t (and (not (set-has? s4 :r)) (set-has? s4 :s)))

(define su (set-union (set #1 #2) (set #2 #3)))
(test-case (quote :set-union) #3 (set-size su))

(define si (set-intersection (set #1 #2 #3) (set #2 #3 #4)))
(test-case (quote :set-intersection) #2 (set-size si))

(define sd (set-difference (set #1 #2 #3) (set #2)))
(test-case (quote :set-difference) #2 (set-size sd))

(test-case (quote :set-type-pred) #t (and (set? (set)) (not (set? #42))))
