; Test De Bruijn converter handles strings correctly
; Day 40: De Bruijn string support fix

; Test 1: Lambda with string literals should work
(test-case :string-in-lambda
   "hello"
   ((lambda (x) "hello") #42))

; Test 2: Lambda comparing string with parameter
(test-case :string-compare
   #t
   ((lambda (s) (string-equal? s "test")) "test"))

; Test 3: Nested lambda with strings (2 levels)
(test-case :nested-with-strings-2
   "inner"
   ((lambda (outer)
     ((lambda (inner)
       inner)
      "inner"))
    "outer"))

; Test 4: Nested lambda with strings (3 levels)
(test-case :nested-with-strings-3
   "level3"
   ((lambda (l1)
     ((lambda (l2)
       ((lambda (l3)
         l3)
        "level3"))
      "level2"))
    "level1"))

; Test 5: Lambda using string operations
(test-case :string-ops-in-lambda
   #7
   ((lambda (s) (string-length s)) "testing"))

; Test 6: Nested lambda mixing strings and numbers
(test-case :mixed-nested
   #42
   ((lambda (str)
     ((lambda (num)
       num)
      #42))
    "text"))

; Test 7: String as return value from nested structure
(test-case :string-return
   "result"
   ((lambda (x)
     (if (equal? x #1)
        "result"
        "other"))
    #1))

; Test 8: Multiple string parameters
(test-case :multiple-strings
   "ab"
   ((lambda (a b) (string-append a b)) "a" "b"))

; Test 9: Deep nesting (4 levels) with strings
(test-case :deep-nesting-strings
   "d"
   ((lambda (a)
     ((lambda (b)
       ((lambda (c)
         ((lambda (d)
           d)
          "d"))
        "c"))
      "b"))
    "a"))

; Test 10: Strings in conditional within lambda
(test-case :conditional-strings
   "yes"
   ((lambda (test)
     (if test "yes" "no"))
    #t))
