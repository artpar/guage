; Just sort tests
(load "bootstrap/stdlib/list.scm")

(test-case :sort-ascending
   (cons #1 (cons #2 (cons #3 (cons #4 nil))))
   ((⊴ <′) (cons #3 (cons #1 (cons #4 (cons #2 nil))))))

(test-case :sort-descending
   (cons #4 (cons #3 (cons #2 (cons #1 nil))))
   ((⊴ >′) (cons #3 (cons #1 (cons #4 (cons #2 nil))))))

(test-case :sort-already-sorted
   (cons #1 (cons #2 (cons #3 nil)))
   ((⊴ <′) (cons #1 (cons #2 (cons #3 nil)))))

(test-case :sort-single
   (cons #1 nil)
   ((⊴ <′) (cons #1 nil)))

(test-case :sort-empty
   nil
   ((⊴ <′) nil))

(test-case :sort-duplicates
   (cons #1 (cons #1 (cons #2 (cons #3 (cons #3 nil)))))
   ((⊴ <′) (cons #3 (cons #1 (cons #2 (cons #3 (cons #1 nil)))))))

(test-case :sortby-modulo
   (cons #4 (cons #2 (cons #3 (cons #1 nil))))
   ((⊴< (lambda (n) (% n #2))) (cons #3 (cons #1 (cons #4 (cons #2 nil))))))

(test-case :sortby-identity
   (cons #1 (cons #2 (cons #3 nil)))
   ((⊴< (lambda (n) n)) (cons #3 (cons #1 (cons #2 nil)))))

(test-case :sortby-empty
   nil
   ((⊴< (lambda (n) n)) nil))
