; Test: Char Primitives + Case Conversion
; Day 119

; 1. char-code-basic — get code of 'A'
(test-case (quote :char-code-basic) #65 (string-char-code "A" #0))

; 2. char-code-lowercase — get code of 'a'
(test-case (quote :char-code-lowercase) #97 (string-char-code "a" #0))

; 3. char-code-digit — get code of '0'
(test-case (quote :char-code-digit) #48 (string-char-code "0" #0))

; 4. char-code-space — get code of space
(test-case (quote :char-code-space) #32 (string-char-code " " #0))

; 5. char-code-index — get code at position 4 of "Hello" -> 'o' = 111
(test-case (quote :char-code-index) #111 (string-char-code "Hello" #4))

; 6. char-code-bounds — out of bounds returns error
(test-case (quote :char-code-bounds) #t (error? (string-char-code "x" #5)))

; 7. code-to-char-basic — code 65 -> "A"
(test-case (quote :code-to-char-basic) "A" (code->char #65))

; 8. code-to-char-digit — code 48 -> "0"
(test-case (quote :code-to-char-digit) "0" (code->char #48))

; 9. code-to-char-space — code 32 -> " "
(test-case (quote :code-to-char-space) " " (code->char #32))

; 10. code-to-char-invalid — negative code returns error
(test-case (quote :code-to-char-invalid) #t (error? (code->char #-1)))

; 11. code-to-char-too-high — code > 127 returns error
(test-case (quote :code-to-char-too-high) #t (error? (code->char #200)))

; 12. upcase-basic — lowercase to uppercase
(test-case (quote :upcase-basic) "HELLO" (string-upcase "hello"))

; 13. upcase-mixed — mixed case + spaces
(test-case (quote :upcase-mixed) "HELLO WORLD" (string-upcase "Hello World"))

; 14. upcase-numbers — numbers unchanged
(test-case (quote :upcase-numbers) "ABC123" (string-upcase "abc123"))

; 15. upcase-empty — empty string
(test-case (quote :upcase-empty) "" (string-upcase ""))

; 16. downcase-basic — uppercase to lowercase
(test-case (quote :downcase-basic) "hello" (string-downcase "HELLO"))

; 17. downcase-mixed — mixed case + spaces
(test-case (quote :downcase-mixed) "hello world" (string-downcase "Hello World"))

; 18. roundtrip — upcase then downcase
(test-case (quote :roundtrip) "test" (string-downcase (string-upcase "Test")))

; 19. char-code-roundtrip — code→char→code
(test-case (quote :char-code-roundtrip) #65 (string-char-code (code->char #65) #0))
