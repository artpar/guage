; â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
; Extended List Operations - Day 36
; â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
; Pure symbolic names, no English keywords
; Self-documenting via comments and examples
; â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

; â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
; ZIP OPERATIONS
; â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

; âŠ•âŠ™ :: [Î±] -> [Î²] -> [âŸ¨Î± Î²âŸ©]
; Zip two lists into list of pairs (stops at shorter list)
; Example: (âŠ•âŠ™ âŸ¨#1 âŸ¨#2 âŸ¨#3 âˆ…âŸ©âŸ©âŸ© âŸ¨#4 âŸ¨#5 âŸ¨#6 âˆ…âŸ©âŸ©âŸ©)
;          -> âŸ¨âŸ¨#1 #4âŸ© âŸ¨âŸ¨#2 #5âŸ© âŸ¨âŸ¨#3 #6âŸ© âˆ…âŸ©âŸ©âŸ©
(define âŠ•âŠ™ (lambda (ğ•©ğ•¤ ğ•ªğ•¤)
  (if (null? ğ•©ğ•¤)
     nil
     (if (null? ğ•ªğ•¤)
        nil
        (cons (cons (car ğ•©ğ•¤) (car ğ•ªğ•¤)) (âŠ•âŠ™ (cdr ğ•©ğ•¤) (cdr ğ•ªğ•¤)))))))

; âŠ•âŠ™â†’ :: (Î± -> Î² -> Î³) -> [Î±] -> [Î²] -> [Î³]
; Zip two lists with function (apply function to corresponding pairs)
; Example: ((âŠ•âŠ™â†’ +) âŸ¨#1 âŸ¨#2 âˆ…âŸ©âŸ© âŸ¨#3 âŸ¨#4 âˆ…âŸ©âŸ©) -> âŸ¨#4 âŸ¨#6 âˆ…âŸ©âŸ©
(define âŠ•âŠ™â†’ (lambda (ğ•—)
  (lambda (ğ•©ğ•¤ ğ•ªğ•¤)
    (if (null? ğ•©ğ•¤)
       nil
       (if (null? ğ•ªğ•¤)
          nil
          (cons ((ğ•— (car ğ•©ğ•¤)) (car ğ•ªğ•¤)) ((âŠ•âŠ™â†’ ğ•—) (cdr ğ•©ğ•¤) (cdr ğ•ªğ•¤))))))))

; â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
; CONDITIONAL OPERATIONS
; â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

; âŠ™â–·â†’ :: (Î± -> Bool) -> [Î±] -> [Î±]
; Take elements from start while predicate is true
; Example: ((âŠ™â–·â†’ (lambda (ğ•©) (< ğ•© #5))) âŸ¨#1 âŸ¨#2 âŸ¨#7 âŸ¨#3 âˆ…âŸ©âŸ©âŸ©âŸ©) -> âŸ¨#1 âŸ¨#2 âˆ…âŸ©âŸ©
(define âŠ™â–·â†’ (lambda (ğ•¡)
  (lambda (ğ•©ğ•¤)
    (if (null? ğ•©ğ•¤)
       nil
       (if (ğ•¡ (car ğ•©ğ•¤))
          (cons (car ğ•©ğ•¤) ((âŠ™â–·â†’ ğ•¡) (cdr ğ•©ğ•¤)))
          nil)))))

; âŠ™â—â†’ :: (Î± -> Bool) -> [Î±] -> [Î±]
; Drop elements from start while predicate is true
; Example: ((âŠ™â—â†’ (lambda (ğ•©) (< ğ•© #5))) âŸ¨#1 âŸ¨#2 âŸ¨#7 âŸ¨#3 âˆ…âŸ©âŸ©âŸ©âŸ©) -> âŸ¨#7 âŸ¨#3 âˆ…âŸ©âŸ©
(define âŠ™â—â†’ (lambda (ğ•¡)
  (lambda (ğ•©ğ•¤)
    (if (null? ğ•©ğ•¤)
       nil
       (if (ğ•¡ (car ğ•©ğ•¤))
          ((âŠ™â—â†’ ğ•¡) (cdr ğ•©ğ•¤))
          ğ•©ğ•¤)))))

; âŠ™âŠ‚â†’ :: (Î± -> Bool) -> [Î±] -> âŸ¨[Î±] [Î±]âŸ©
; Split list at first element where predicate fails (span)
; Returns pair: (taken, remaining)
; Example: ((âŠ™âŠ‚â†’ (lambda (ğ•©) (< ğ•© #5))) âŸ¨#1 âŸ¨#2 âŸ¨#7 âŸ¨#3 âˆ…âŸ©âŸ©âŸ©âŸ©)
;          -> âŸ¨âŸ¨#1 âŸ¨#2 âˆ…âŸ©âŸ© âŸ¨#7 âŸ¨#3 âˆ…âŸ©âŸ©âŸ©
(define âŠ™âŠ‚â†’ (lambda (ğ•¡)
  (lambda (ğ•©ğ•¤)
    (cons ((âŠ™â–·â†’ ğ•¡) ğ•©ğ•¤) ((âŠ™â—â†’ ğ•¡) ğ•©ğ•¤)))))

; â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
; SET-LIKE OPERATIONS
; â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

; âŠ™âŠ†â†’ :: Î± -> [Î±] -> Bool
; Check if element is in list
; Example: ((âŠ™âŠ†â†’ #3) âŸ¨#1 âŸ¨#2 âŸ¨#3 âŸ¨#4 âˆ…âŸ©âŸ©âŸ©âŸ©) -> #t
(define âŠ™âŠ†â†’ (lambda (ğ•–)
  (lambda (ğ•©ğ•¤)
    (if (null? ğ•©ğ•¤)
       #f
       (if (equal? (car ğ•©ğ•¤) ğ•–)
          #t
          ((âŠ™âŠ†â†’ ğ•–) (cdr ğ•©ğ•¤)))))))

; Helper for unique - track seen elements
(define âŠ™â‰¡â†’-helper (lambda (ğ•¤ğ•–ğ•–ğ•Ÿ)
  (lambda (ğ•©ğ•¤)
    (if (null? ğ•©ğ•¤)
       nil
       (if ((âŠ™âŠ†â†’ (car ğ•©ğ•¤)) ğ•¤ğ•–ğ•–ğ•Ÿ)
          ((âŠ™â‰¡â†’-helper ğ•¤ğ•–ğ•–ğ•Ÿ) (cdr ğ•©ğ•¤))
          (cons (car ğ•©ğ•¤) ((âŠ™â‰¡â†’-helper (cons (car ğ•©ğ•¤) ğ•¤ğ•–ğ•–ğ•Ÿ)) (cdr ğ•©ğ•¤))))))))

; âŠ™â‰¡â†’ :: [Î±] -> [Î±]
; Remove duplicates (keep first occurrence)
; Example: (âŠ™â‰¡â†’ âŸ¨#1 âŸ¨#2 âŸ¨#1 âŸ¨#3 âŸ¨#2 âˆ…âŸ©âŸ©âŸ©âŸ©âŸ©) -> âŸ¨#1 âŸ¨#2 âŸ¨#3 âˆ…âŸ©âŸ©âŸ©
(define âŠ™â‰¡â†’ (lambda (ğ•©ğ•¤)
  ((âŠ™â‰¡â†’-helper nil) ğ•©ğ•¤)))

; âŠ™âŠ–â†’ :: [Î±] -> [Î±] -> [Î±]
; Difference: elements in first list not in second
; Example: ((âŠ™âŠ–â†’ âŸ¨#1 âŸ¨#2 âŸ¨#3 âˆ…âŸ©âŸ©âŸ©) âŸ¨#2 âŸ¨#4 âˆ…âŸ©âŸ©) -> âŸ¨#1 âŸ¨#3 âˆ…âŸ©âŸ©
(define âŠ™âŠ–â†’ (lambda (ğ•©ğ•¤)
  (lambda (ğ•ªğ•¤)
    (if (null? ğ•©ğ•¤)
       nil
       (if ((âŠ™âŠ†â†’ (car ğ•©ğ•¤)) ğ•ªğ•¤)
          ((âŠ™âŠ–â†’ (cdr ğ•©ğ•¤)) ğ•ªğ•¤)
          (cons (car ğ•©ğ•¤) ((âŠ™âŠ–â†’ (cdr ğ•©ğ•¤)) ğ•ªğ•¤)))))))

; âŠ™âŠ—â†’ :: [Î±] -> [Î±] -> [Î±]
; Intersection: elements in both lists
; Example: ((âŠ™âŠ—â†’ âŸ¨#1 âŸ¨#2 âŸ¨#3 âˆ…âŸ©âŸ©âŸ©) âŸ¨#2 âŸ¨#3 âŸ¨#4 âˆ…âŸ©âŸ©âŸ©) -> âŸ¨#2 âŸ¨#3 âˆ…âŸ©âŸ©
(define âŠ™âŠ—â†’ (lambda (ğ•©ğ•¤)
  (lambda (ğ•ªğ•¤)
    (if (null? ğ•©ğ•¤)
       nil
       (if ((âŠ™âŠ†â†’ (car ğ•©ğ•¤)) ğ•ªğ•¤)
          (cons (car ğ•©ğ•¤) ((âŠ™âŠ—â†’ (cdr ğ•©ğ•¤)) ğ•ªğ•¤))
          ((âŠ™âŠ—â†’ (cdr ğ•©ğ•¤)) ğ•ªğ•¤))))))

; â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
; PREDICATES
; â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

; âŠ™âˆ§â†’ :: (Î± -> Bool) -> [Î±] -> Bool
; Check if all elements satisfy predicate
; Example: ((âŠ™âˆ§â†’ (lambda (ğ•©) (< ğ•© #10))) âŸ¨#1 âŸ¨#2 âŸ¨#3 âˆ…âŸ©âŸ©âŸ©) -> #t
(define âŠ™âˆ§â†’ (lambda (ğ•¡)
  (lambda (ğ•©ğ•¤)
    (if (null? ğ•©ğ•¤)
       #t
       (if (ğ•¡ (car ğ•©ğ•¤))
          ((âŠ™âˆ§â†’ ğ•¡) (cdr ğ•©ğ•¤))
          #f)))))

; âŠ™âˆ¨â†’ :: (Î± -> Bool) -> [Î±] -> Bool
; Check if any element satisfies predicate
; Example: ((âŠ™âˆ¨â†’ (lambda (ğ•©) (> ğ•© #5))) âŸ¨#1 âŸ¨#2 âŸ¨#7 âˆ…âŸ©âŸ©âŸ©) -> #t
(define âŠ™âˆ¨â†’ (lambda (ğ•¡)
  (lambda (ğ•©ğ•¤)
    (if (null? ğ•©ğ•¤)
       #f
       (if (ğ•¡ (car ğ•©ğ•¤))
          #t
          ((âŠ™âˆ¨â†’ ğ•¡) (cdr ğ•©ğ•¤)))))))

; â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
; PARTITIONING & GROUPING
; â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

; âŠ™âŠ²âŠ²â†’ :: (Î± -> Bool) -> [Î±] -> âŸ¨[Î±] [Î±]âŸ©
; Partition list into two lists: (satisfying predicate, not satisfying)
; Example: ((âŠ™âŠ²âŠ²â†’ (lambda (ğ•©) (equal? (% ğ•© #2) #0))) âŸ¨#1 âŸ¨#2 âŸ¨#3 âŸ¨#4 âˆ…âŸ©âŸ©âŸ©âŸ©)
;          -> âŸ¨âŸ¨#2 âŸ¨#4 âˆ…âŸ©âŸ© âŸ¨#1 âŸ¨#3 âˆ…âŸ©âŸ©âŸ©
(define âŠ™âŠ²âŠ²â†’ (lambda (ğ•¡)
  (lambda (ğ•©ğ•¤)
    (if (null? ğ•©ğ•¤)
       (cons nil nil)
       (if (ğ•¡ (car ğ•©ğ•¤))
          (cons (cons (car ğ•©ğ•¤) (car ((âŠ™âŠ²âŠ²â†’ ğ•¡) (cdr ğ•©ğ•¤)))) (cdr ((âŠ™âŠ²âŠ²â†’ ğ•¡) (cdr ğ•©ğ•¤))))
          (cons (car ((âŠ™âŠ²âŠ²â†’ ğ•¡) (cdr ğ•©ğ•¤))) (cons (car ğ•©ğ•¤) (cdr ((âŠ™âŠ²âŠ²â†’ ğ•¡) (cdr ğ•©ğ•¤))))))))))

; â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
; LIST MANIPULATION
; â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

; Helper: append two lists
(define âŠ™âŠ•âŠ•-append (lambda (ğ•©ğ•¤ ğ•ªğ•¤)
  (if (null? ğ•©ğ•¤)
     ğ•ªğ•¤
     (cons (car ğ•©ğ•¤) (âŠ™âŠ•âŠ•-append (cdr ğ•©ğ•¤) ğ•ªğ•¤)))))

; âŠ™âŠ•âŠ•â†’ :: [[Î±]] -> [Î±]
; Flatten list of lists (concat)
; Example: (âŠ™âŠ•âŠ•â†’ âŸ¨âŸ¨#1 âŸ¨#2 âˆ…âŸ©âŸ© âŸ¨âŸ¨#3 âŸ¨#4 âˆ…âŸ©âŸ© âˆ…âŸ©âŸ©) -> âŸ¨#1 âŸ¨#2 âŸ¨#3 âŸ¨#4 âˆ…âŸ©âŸ©âŸ©âŸ©
(define âŠ™âŠ•âŠ•â†’ (lambda (ğ•©ğ•¤ğ•¤)
  (if (null? ğ•©ğ•¤ğ•¤)
     nil
     (âŠ™âŠ•âŠ•-append (car ğ•©ğ•¤ğ•¤) (âŠ™âŠ•âŠ•â†’ (cdr ğ•©ğ•¤ğ•¤))))))

; âŠ™â‹ˆâ†’ :: [Î±] -> [Î±] -> [Î±]
; Interleave two lists (stops when shorter list ends)
; Example: ((âŠ™â‹ˆâ†’ âŸ¨#1 âŸ¨#2 âŸ¨#3 âˆ…âŸ©âŸ©âŸ©) âŸ¨#4 âŸ¨#5 âŸ¨#6 âˆ…âŸ©âŸ©âŸ©)
;          -> âŸ¨#1 âŸ¨#4 âŸ¨#2 âŸ¨#5 âŸ¨#3 âŸ¨#6 âˆ…âŸ©âŸ©âŸ©âŸ©âŸ©âŸ©
(define âŠ™â‹ˆâ†’ (lambda (ğ•©ğ•¤)
  (lambda (ğ•ªğ•¤)
    (if (null? ğ•©ğ•¤)
       nil
       (if (null? ğ•ªğ•¤)
          nil
          (cons (car ğ•©ğ•¤) (cons (car ğ•ªğ•¤) ((âŠ™â‹ˆâ†’ (cdr ğ•©ğ•¤)) (cdr ğ•ªğ•¤)))))))))

; âŠ™â‰ªâ†’ :: â„• -> [Î±] -> [Î±]
; Rotate list left by n positions
; Example: ((âŠ™â‰ªâ†’ #2) âŸ¨#1 âŸ¨#2 âŸ¨#3 âŸ¨#4 âŸ¨#5 âˆ…âŸ©âŸ©âŸ©âŸ©âŸ©)
;          -> âŸ¨#3 âŸ¨#4 âŸ¨#5 âŸ¨#1 âŸ¨#2 âˆ…âŸ©âŸ©âŸ©âŸ©âŸ©
(define âŠ™â‰ªâ†’ (lambda (ğ•Ÿ)
  (lambda (ğ•©ğ•¤)
    (if (equal? ğ•Ÿ #0)
       ğ•©ğ•¤
       (if (null? ğ•©ğ•¤)
          nil
          ((âŠ™â‰ªâ†’ (- ğ•Ÿ #1)) (âŠ™âŠ•âŠ•-append (cdr ğ•©ğ•¤) (cons (car ğ•©ğ•¤) nil))))))))

; âŠ™âŠ³â†’ :: [Î±] -> Î± | error
; Safe head
; Example: (âŠ™âŠ³â†’ âŸ¨#1 âŸ¨#2 âˆ…âŸ©âŸ©) -> #1
;          (âŠ™âŠ³â†’ nil) -> âš :empty-list
(define âŠ™âŠ³â†’ (lambda (ğ•©ğ•¤)
  (if (null? ğ•©ğ•¤)
     (error :empty-list nil)
     (car ğ•©ğ•¤))))

; âŠ™âŠ´â†’ :: [Î±] -> [Î±] | error
; Safe tail
; Example: (âŠ™âŠ´â†’ âŸ¨#1 âŸ¨#2 âˆ…âŸ©âŸ©) -> âŸ¨#2 âˆ…âŸ©
;          (âŠ™âŠ´â†’ nil) -> âš :empty-list
(define âŠ™âŠ´â†’ (lambda (ğ•©ğ•¤)
  (if (null? ğ•©ğ•¤)
     (error :empty-list nil)
     (cdr ğ•©ğ•¤))))

; âŠ™#â†’ :: [Î±] -> â„•
; Length of list
; Example: (âŠ™#â†’ âŸ¨#1 âŸ¨#2 âŸ¨#3 âˆ…âŸ©âŸ©âŸ©) -> #3
(define âŠ™#â†’ (lambda (ğ•©ğ•¤)
  (if (null? ğ•©ğ•¤)
     #0
     (+ #1 (âŠ™#â†’ (cdr ğ•©ğ•¤))))))

; â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
; END: 20 extended list operations complete
; â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
